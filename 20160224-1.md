# 为什么容器可以让云端的应用更快，更便宜？

首先我们要讲一下容器和传统的虚拟化的区别，其中一个比较大的区别就是，传统的虚拟化是基于Hyper-V技术的，比如Xen, KVM, VMWare。这些虚拟化就是都是基于
硬件的虚拟化技术，而容器是基于操作系统的虚拟化技术。很明显，容器所处的层级更靠上，那么运行在容器之上的应用程序就省去了操作系统这一层。
基于OS的虚拟化技术，其实很早在2000年，比如LXC(Linux Container), Solaris Jails以及Google 的Borg，当我们使用google search, gmail 等一系列服务的时候
其实都会涉及到容器的操作。但是这些系统都没有流行起来，原因是这些系统都要求主机运行在相同的系统上。随着公有云的普及，对于容器的需求逐渐增大，主要是从以下几点来进行考虑的：

## 成本因素

传统的云计算的成本主要是通过用户所使用的虚拟主机数来进行计费的，在很多场景下都是不错的，但是在某些时候你可能会需要更小粒度的主机，举个例子
之前我曾经尝过鲜，用了以下AWS，AWS是先使用后付费。用的时候挺爽，一个月后短信账单一看1000多元，那个心痛啊！如果你用过阿里云的主机，一个最低配置的主机，都足以运行3个java webservice。如果你的系统是有20个web应用组成的，你可以购买20台云主机，也可以购买
几台性能很好的主机。如果你的应用可以同时运行在一台主机还没什么大问题，当你需要一个应用运行在单台主机的时候，就需要购买20台主机。而过多的主机不仅管理成本
高，而且价格上也不便宜。因此，一个比较好的方案是，在性能不错的主机上，运行20个容器，然后每个应用以微服务的方式运行，这种架构的成本通常会更低。
在公有云上使用容器，就是在虚拟化上再虚拟化，通过这种方式可以将应用程序进一步的细化，也可以在同一时间在有限资源上运行多个程序。很多人会觉得
容器是不是会影响性能，其实根本不会。容器是操作系统之上的虚拟化，实际就是一个进程，曾经我有一篇PPT专门对性能做了比较分析。所以，这儿就回到
容器的根源上来——操作系统之上的虚拟化，省去了操作系统的空间和操作系统的进程，因此会很大程度上节约成本。

## 更有效的分发软件，更合理的分配负载

我们在谈论虚拟化的时候，其实是有一个假设条件的，到底用户需要什么样的服务，需要的服务是什么层级的是有前提的。举个例子，汽车是跑在路上的，
飞机是飞在天上的，制造商是绝不会去给他们设计一个可以在水上跑的功能。如果设计出来了，就是画蛇添足。这个看似很简单的道理，却在现在公有云
上是普遍的问题。对于目前普遍的互联网应用来说，是根本不关心硬件的，而基于Hyper-V的虚拟化，却是要对硬件进行虚拟化的。所以，容器就是为了解决这个问题。
因此，容器本身也不是万能的，也无法替代Hyper-V。比如，当你需要对内核和硬件进行开发时，显然不适合用容器。随着SaaS服务的兴起，用户对运行应用的
底层系统和硬件都不再关心，通过互联网和浏览器就可以满足需求。所以，容器比较适合的领域就是以服务形式导出的应用，最常见的就是webservice，
网站后端，移动应用后端。随着容器的出现，以后的分发不再是以程序或者代码，而是附带了操作系统等运行环境的。这就对开发和测试进行了有效的统一，
应用可以伴随容器在任意环境中运行，降低了耦合度。

## 快速扩展

云计算要解决的首要问题就是水平扩展的问题，当系统规模扩大的时候，如何快速的扩展和有效的管理就是必须要面对的问题。传统的虚拟机的启动时间都是分钟级的，长的可能要10多分钟。
而容器的启动时间是秒级的，最多也就10多秒。如果在一个庞大的系统中，传统虚拟化启动时间伴随着依赖关系会更长，因此，容器更适合系统扩展。

## 有哪些容器系统

之前就提到，容器技术出现其实不是一两年的时间，但目前来看Docker无疑是这个市场的领导者，占了70%左右的市场份额。除此之外，也有CoreOS的rkt，有兴趣都可以尝试一下。
